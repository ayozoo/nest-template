# 使用 Docker Compose 管理本地 PostgreSQL 数据库
#
# 学习要点：
# - image 指定镜像版本（这里使用 15-alpine 体积更小）
# - environment 注入数据库初始用户名/密码/数据库名
# - ports 将容器的 5432 端口映射到宿主机（按 .env 中的 DB_PORT）
# - volumes 持久化数据库文件到宿主机，避免数据因容器重建丢失
# - networks 可用于多服务互联（这里定义了一个专用网络）
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    container_name: nest_postgres
    environment:
      POSTGRES_USER: ${DB_USERNAME}
      POSTGRES_PASSWORD: ${DB_PASSWORD}
      POSTGRES_DB: ${DB_DATABASE}
    ports:
      - "${DB_PORT}:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - nest-network

networks:
  nest-network:

volumes:
  postgres_data:
